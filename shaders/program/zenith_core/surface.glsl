/*
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ğŸŒŸ zenith_core | surface - Ù†Ø¸Ø§Ù… Ø±Ù†Ø¯Ø±ÙŠÙ†Øº Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª ÙˆØ§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø³Ø·Ø­ÙŠØ© | VcorA ğŸŒŸ
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    Surface Particle & Atmospheric Effects Rendering System
    Ù†Ø¸Ø§Ù… Ø±Ù†Ø¯Ø±ÙŠÙ†Øº Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª ÙˆØ§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¬ÙˆÙŠØ©

    âš¡ Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© / Core Features:
    ----------------------------------------
    â€¢ Ù†Ø¸Ø§Ù… ØªØ­Ø³ÙŠÙ† Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø§Øª Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© / Golden Portal Particle Enhancement
    â€¢ Ù†Ø¸Ø§Ù… ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù…Ø·Ø± ÙˆØ§Ù„Ø«Ù„Ø¬ Ø§Ù„Ù…ØªØ·ÙˆØ± / Advanced Rain & Snow Effects
    â€¢ Ù†Ø¸Ø§Ù… ØªØ­Ø³ÙŠÙ† Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø§Ø¡ ÙˆØ§Ù„Ø¯Ø®Ø§Ù† / Water & Smoke Particle Enhancement
    â€¢ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ø¬ÙˆÙŠØ© Ù„Ù„Ø¬Ø³ÙŠÙ…Ø§Øª / Atmospheric Lighting for Particles
    â€¢ Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø´ÙØ§ÙÙŠØ© ÙˆØ§Ù„Ù…ÙˆØ§Ø¯ / Transparency & Material Control
    â€¢ Ù†Ø¸Ø§Ù… ÙƒØ´Ù Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ø­Ø±ÙŠØ© / Magical End Particles Detection

    ğŸ¯ Ø§Ù„Ø£Ù†Ø¸Ù…Ø© Ø§Ù„ÙØ±Ø¹ÙŠØ© / Subsystems:
    --------------------------------
    [Ø­Ø±ÙƒØ© Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª] - Particle Movement Systems
    [ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù†Ø§Ø± ÙˆØ§Ù„Ø­Ù…Ù…] - Fire & Lava Effects
    [ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø§Øª Ø§Ù„Ø³Ø­Ø±ÙŠØ©] - Portal Magic Effects
    [ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©] - Golden Color Enhancement
    [ÙƒØ´Ù Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ø·Ù‚Ø³] - Weather Particle Detection
    [ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù…Ø®ØªÙ„ÙØ©] - Multi-Dimensional Effects

    ğŸ“ˆ Ø§Ù„ØªØ­Ø³ÙŠÙ†Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© / Advanced Optimizations:
    ----------------------------------------------
    â˜… TAA Support: Ø¯Ø¹Ù… Ø§Ù„ØªÙ†Ø¹ÙŠÙ… Ø§Ù„Ø²Ù…Ù†ÙŠ
    â˜… Cloud Culling: Ù‚Ø·Ø¹ Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø°ÙƒÙŠ
    â˜… Distance-Based Effects: ØªØ£Ø«ÙŠØ±Ø§Øª Ù‚Ø§Ø¦Ù…Ø© Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§ÙØ©
    â˜… Atmospheric Color Integration: ØªÙƒØ§Ù…Ù„ Ø£Ù„ÙˆØ§Ù† Ø¬ÙˆÙŠØ©
    â˜… Multi-Atlas Support: Ø¯Ø¹Ù… Ø£Ø·Ù„Ø³ Ù…ØªØ¹Ø¯Ø¯

    ğŸ”§ Ù…Ø·ÙˆØ± Ø¨ÙˆØ§Ø³Ø·Ø© / Developed by: VcorA
    ğŸ“… Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø®ÙŠØ± / Last Updated: 2025
    ğŸ® Ù…ØªÙˆØ§ÙÙ‚ Ù…Ø¹ / Compatible with: OptiFine & Iris

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
*/

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Core Library Includes | Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#include "/lib/shader_modules/shader_master.glsl"

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Fragment Shader Implementation | ØªØ·Ø¨ÙŠÙ‚ Fragment Shader
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#ifdef FRAGMENT_SHADER

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Input Variables | Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
in vec2 texCoord;      // Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù†Ø³ÙŠØ¬ / Texture coordinates
in vec2 lmCoord;       // Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© / Light map coordinates

flat in vec3 upVec, sunVec; // Ù…ØªØ¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØ¬Ø§Ù‡ / Direction vectors
in vec3 normal;        // Ø§Ù„Ù…ØªØ¬Ù‡ Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ / Normal vector

flat in vec4 glColor;  // Ù„ÙˆÙ† OpenGL / OpenGL color

#ifdef CLOUD_SHADOWS
    flat in vec3 eastVec; // Ù…ØªØ¬Ù‡ Ø§Ù„Ø´Ø±Ù‚ / East vector

    #if SUN_ANGLE != 0
        flat in vec3 northVec; // Ù…ØªØ¬Ù‡ Ø§Ù„Ø´Ù…Ø§Ù„ / North vector
    #endif
#endif

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Atmospheric Calculations | Ø­Ø³Ø§Ø¨Ø§Øª Ø§Ù„ØºÙ„Ø§Ù Ø§Ù„Ø¬ÙˆÙŠ
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
float NdotU = dot(normal, upVec);
float NdotUmax0 = max(NdotU, 0.0);
float SdotU = dot(sunVec, upVec);

// Ù†Ø¸Ø§Ù… ØªØ­Ø¯ÙŠØ¯ ÙˆÙ‚Øª Ø§Ù„Ø´Ù…Ø³ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… / Advanced Sun Time Detection System
float sunFactor = SdotU < 0.0 ? 
    clamp(SdotU + 0.375, 0.0, 0.75) / 0.75 : 
    clamp(SdotU + 0.03125, 0.0, 0.0625) / 0.0625;

float sunVisibility = clamp(SdotU + 0.0625, 0.0, 0.125) / 0.125;
float sunVisibility2 = sunVisibility * sunVisibility;
float shadowTimeVar1 = abs(sunVisibility - 0.5) * 2.0;
float shadowTimeVar2 = shadowTimeVar1 * shadowTimeVar1;
float shadowTime = shadowTimeVar2 * shadowTimeVar2;

// Ù†Ø¸Ø§Ù… Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ø¶ÙˆØ¡ Ù„Ù„Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù…Ø®ØªÙ„ÙØ© / Multi-Dimensional Light Direction System
#ifdef OVERWORLD
    vec3 lightVec = sunVec * ((timeAngle < 0.5325 || timeAngle > 0.9675) ? 1.0 : -1.0);
#else
    vec3 lightVec = sunVec;
#endif

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Essential Library Includes | Ø§Ù„Ù…ÙƒØªØ¨Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
#include "/lib/atmospherics/zenith_atmospheric_core.glsl"
#include "/lib/illumination_systems/core_illumination_system.glsl"

#if MC_VERSION >= 11500
    #include "/lib/atmospherics/particles/mainParticles.glsl"
#endif

#ifdef ATM_COLOR_MULTS
    #include "/lib/color_schemes/color_effects_system.glsl"
#endif

#ifdef COLOR_CODED_PROGRAMS
    #include "/lib/effects/effects_unified.glsl"
#endif

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Main Surface Rendering Function | Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ø±Ù†Ø¯Ø±ÙŠÙ†Øº Ø§Ù„Ø³Ø·Ø­
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
void main() {
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Initial Color Setup | Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£ÙˆÙ„ÙŠ
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    vec4 color = texture2D(tex, texCoord);
    vec4 colorP = color; // Ø§Ø­ØªÙØ¸ Ø¨Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø£ØµÙ„ÙŠØ© / Preserve original colors
    color *= glColor;

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Spatial Coordinate System | Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù…ÙƒØ§Ù†ÙŠØ©
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    vec3 screenPos = vec3(gl_FragCoord.xy / vec2(viewWidth, viewHeight), gl_FragCoord.z);
    vec3 viewPos = ScreenToView(screenPos);
    float lViewPos = length(viewPos);
    vec3 playerPos = ViewToPlayer(viewPos);

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Advanced Dithering System | Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ´ÙˆÙŠØ´ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    float dither = texture2D(noisetex, gl_FragCoord.xy / 128.0).b;
    #ifdef TAA
        dither = fract(dither + goldenRatio * mod(float(frameCounter), 3600.0));
    #endif

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Atmospheric Color Enhancement | ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ø§Ù„Ø¬ÙˆÙŠØ©
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    #ifdef ATM_COLOR_MULTS
        atmColorMult = GetAtmColorMult();
    #endif

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Cloud Depth Culling System | Ù†Ø¸Ø§Ù… Ù‚Ø·Ø¹ Ø¹Ù…Ù‚ Ø§Ù„Ø³Ø­Ø¨
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    #ifdef VL_CLOUDS_ACTIVE
        float cloudLinearDepth = texelFetch(gaux1, texelCoord, 0).r;

        if (cloudLinearDepth > 0.0) // Iris pipeline position adjustment
        if (pow2(cloudLinearDepth + OSIEBCA * dither) * renderDistance < min(lViewPos, renderDistance)) 
            discard;
    #endif

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Material Properties Setup | Ø¥Ø¹Ø¯Ø§Ø¯ Ø®ØµØ§Ø¦Øµ Ø§Ù„Ù…ÙˆØ§Ø¯
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    float emission = 0.0;
    float materialMask = OSIEBCA * 254.0; // ØªØ¹Ø·ÙŠÙ„ SSAO Ùˆ TAA / Disable SSAO & TAA
    vec2 lmCoordM = lmCoord;
    vec3 normalM = normal, geoNormal = normal, shadowMult = vec3(1.0);
    vec3 worldGeoNormal = normalize(ViewToPlayer(geoNormal * 10000.0));

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Advanced Particle Enhancement System | Ù†Ø¸Ø§Ù… ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    #if defined IPBR && defined IPBR_PARTICLE_FEATURES
        // ØªØ­Ø¯ÙŠØ¯ Ø­Ø¬Ù… Ø§Ù„Ø£Ø·Ù„Ø³ Ù„Ù„ÙƒØ´Ù Ø¹Ù† Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª / Atlas size detection for particles
        #if MC_VERSION >= 12000
            float atlasCheck = 1200.0; // Ø£Ø·Ù„Ø³ Ø£ÙƒØ¨Ø± ÙÙŠ Ø§Ù„Ø¥ØµØ¯Ø§Ø±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© / Larger atlas in newer versions
        #else
            float atlasCheck = 950.0;
        #endif

        if (atlasSize.x < atlasCheck) {
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            // Golden Water Particle Enhancement | ØªØ­Ø³ÙŠÙ† Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ù…Ø§Ø¡ Ø§Ù„Ø°Ù‡Ø¨ÙŠØ©
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            if (color.b > 1.15 * (color.r + color.g) && color.g > color.r * 1.25 && 
                color.g < 0.425 && color.b > 0.75) {
                if (color.a < 0.1) discard;
                
                // Ø¬Ø³ÙŠÙ…Ø§Øª Ù…Ø§Ø¡ Ø°Ù‡Ø¨ÙŠØ© Ù…ÙƒØ«ÙØ© / Intensified Golden Water Particles
                color.rgb = vec3(1.2, 0.85, 0.25) * 1.5;
                emission = 4.0;
                materialMask = 0.0;
                
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            // Weather Effects Enhancement | ØªØ­Ø³ÙŠÙ† ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø·Ù‚Ø³
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            #ifdef OVERWORLD
            } else if (color.b > 0.7 && color.r < 0.28 && color.g < 0.425 && 
                      color.g > color.r * 1.4) { // ØªØ­Ø³ÙŠÙ† Ù…Ø·Ø± ÙÙŠØ²ÙŠØ§Ø¡ / Physics rain enhancement
                if (color.a < 0.1 || isEyeInWater == 3) discard;
                
                color.a *= rainTexOpacity;
                // Ù„ÙˆÙ† Ù…Ø·Ø± Ø°Ù‡Ø¨ÙŠ Ù…Ø¹Ø²Ø² / Enhanced golden rain color
                vec3 rainGolden = vec3(1.3, 1.1, 0.75);
                color.rgb = sqrt2(color.rgb) * rainGolden * 
                           (blocklightCol * 2.5 * lmCoord.x + 
                            ambientColor * lmCoord.y * (0.8 + 0.4 * sunFactor));
                emission = 2.5; // ØªÙˆÙ‡Ø¬ Ø°Ù‡Ø¨ÙŠ Ù„Ù„Ù…Ø·Ø± / Golden glow for rain
                
            } else if (color.rgb == vec3(1.0) && color.a < 0.765 && color.a > 0.605) {
                // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø«Ù„Ø¬ / Snow enhancement
                if (color.a < 0.1 || isEyeInWater == 3) discard;
                
                color.a *= snowTexOpacity;
                // Ø«Ù„Ø¬ Ø°Ù‡Ø¨ÙŠ Ù†Ø§Ø¹Ù… / Soft golden snow
                vec3 snowGolden = vec3(1.1, 1.05, 0.9);
                color.rgb = sqrt2(color.rgb) * snowGolden * 
                           (blocklightCol * 2.2 * lmCoord.x + 
                            lmCoord.y * (0.75 + 0.4 * sunFactor) + 
                            ambientColor * 0.25);
                emission = 1.0; // ØªÙˆÙ‡Ø¬ Ø®ÙÙŠÙ Ù„Ù„Ø«Ù„Ø¬ / Soft glow for snow
            #endif
                
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            // Underwater Particle Enhancement | ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª ØªØ­Øª Ø§Ù„Ù…Ø§Ø¡
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            } else if (color.r == color.g && color.r - 0.5 * color.b < 0.06) {
                // Ø¬Ø³ÙŠÙ…Ø§Øª Ù…Ø§Ø¡ ØªØ­Øª Ø§Ù„Ù…Ø§Ø¡ Ø°Ù‡Ø¨ÙŠØ© / Golden underwater particles
                color.rgb = vec3(1.2, 0.8, 0.15) * 1.8;
                emission = 5.0; // ØªÙˆÙ‡Ø¬ Ù‚ÙˆÙŠ / Strong glow
                materialMask = 0.0;
                
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            // Smoke Particle Enhancement | ØªØ­Ø³ÙŠÙ† Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ø¯Ø®Ø§Ù†
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            } else if (color.a < 0.99 && dot(color.rgb, color.rgb) < 1.0) {
                color.a *= 0.5;
                // Ø¯Ø®Ø§Ù† Ø°Ù‡Ø¨ÙŠ Ø¯Ø§ÙØ¦ / Warm golden smoke
                vec3 smokeGolden = vec3(1.2, 1.1, 0.9);
                color.rgb *= smokeGolden;
                emission = 2.0; // ØªÙˆÙ‡Ø¬ Ø®ÙÙŠÙ / Subtle glow
                materialMask = 0.0;
                
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            // Grayscale Particle Enhancement | ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ø±Ù…Ø§Ø¯ÙŠØ©
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            } else if (max(abs(colorP.r - colorP.b), abs(colorP.b - colorP.g)) < 0.001) {
                float dotColor = dot(color.rgb, color.rgb);
                
                if (dotColor > 0.25 && color.g < 0.5 && 
                   (color.b > color.r * 1.1 && color.r > 0.3 || 
                    color.r > (color.g + color.b) * 3.0)) {
                    // Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø°Ù‡Ø¨ÙŠØ© / Golden Portal Particles
                    emission = clamp(color.r * 12.0, 3.0, 8.0);
                    
                    vec3 goldenPortalColor = vec3(2.8, 2.3, 0.7);
                    color.rgb = goldenPortalColor * 
                               pow(dot(color.rgb, vec3(0.299, 0.587, 0.114)), 0.7);
                    color.rgb = pow1_5(color.rgb);
                    lmCoordM = vec2(0.0);
                    
                } else if (color.r > 0.83 && color.g > 0.23 && color.b < 0.4) {
                    // Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ø­Ù…Ù… Ø§Ù„Ù…Ø­Ø³Ù†Ø© / Enhanced Lava Particles
                    emission = 3.0;
                    color.b *= 0.4;
                    color.r *= 1.3;
                    color.g *= 1.1;
                }
            }
            
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            // Purple/Magenta to Golden Conversion | ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¨Ù†ÙØ³Ø¬ÙŠ Ø¥Ù„Ù‰ Ø°Ù‡Ø¨ÙŠ
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            if (color.b > color.r * 1.2 && color.b > color.g * 1.3 && color.b > 0.4) {
                vec3 goldenPortalColor = vec3(2.5, 2.0, 0.6);
                float intensity = dot(color.rgb, vec3(0.333));
                color.rgb = goldenPortalColor * intensity * 1.8;
                emission = clamp(intensity * 10.0, 2.0, 6.0);
                lmCoordM = vec2(0.0);
            }
            
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            // End Dimension Magical Effects | ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ù†Ù‡Ø§ÙŠØ© Ø§Ù„Ø³Ø­Ø±ÙŠØ©
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            #ifdef END
                if (color.b > 0.6 || (color.r + color.b > 1.0 && color.g < 0.8)) {
                    // Ø£Ù„ÙˆØ§Ù† Ø³Ø­Ø±ÙŠØ© Ù…ØªØ­Ø±ÙƒØ© / Animated magical colors
                    vec3 endMagicalColor = mix(
                        vec3(2.0, 1.4, 2.8),  // Ø¨Ù†ÙØ³Ø¬ÙŠ Ø°Ù‡Ø¨ÙŠ / Purple-gold
                        vec3(2.3, 2.0, 0.9),  // Ø°Ù‡Ø¨ÙŠ Ø®Ø§Ù„Øµ / Pure gold
                        sin(frameTimeCounter * 4.0 + dot(gl_FragCoord.xy, vec2(0.1))) * 0.5 + 0.5
                    );
                    
                    float magicalIntensity = dot(color.rgb, vec3(0.299, 0.587, 0.114));
                    color.rgb = endMagicalColor * magicalIntensity * 2.0;
                    emission = clamp(magicalIntensity * 15.0, 3.0, 10.0);
                    lmCoordM = vec2(0.0);
                }
            #endif
            
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            // Nether Dimensional Effects | ØªØ£Ø«ÙŠØ±Ø§Øª Ø¨ÙØ¹Ø¯ Ø§Ù„Ø¬Ø­ÙŠÙ…
            // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
            #ifdef NETHER
                if (color.r > 0.7 && color.g < 0.5) {
                    // ØªØ­Ø³ÙŠÙ† Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ø¬Ø­ÙŠÙ… / Nether particle enhancement
                    color.r *= 1.2;
                    color.g *= 1.1;
                    color.b *= 0.8;
                    emission += 1.5;
                }
            #endif
        }
        
        bool noSmoothLighting = false;
    #else
        bool noSmoothLighting = true;
    #endif

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Distance-Based Particle Culling | Ù‚Ø·Ø¹ Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³Ø§ÙØ©
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    #ifdef REDUCE_CLOSE_PARTICLES
        if (lViewPos - 1.0 < dither) discard;
    #endif

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Glowing Colored Particles System | Ù†Ø¸Ø§Ù… Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª Ø§Ù„Ù…Ù„ÙˆÙ†Ø© Ø§Ù„Ù…ØªÙˆÙ‡Ø¬Ø©
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    #ifdef GLOWING_COLORED_PARTICLES
        if (atlasSize.x < 950.0) {
            if (dot(glColor.rgb, vec3(1.0)) < 2.99) {
                emission = 6.0; // ØªÙˆÙ‡Ø¬ Ù…Ø¹Ø²Ø² / Enhanced glow
            }
        }
    #endif

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Advanced Lighting Integration | ØªÙƒØ§Ù…Ù„ Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    DoLighting(color, shadowMult, playerPos, viewPos, lViewPos, geoNormal, normalM, dither,
               worldGeoNormal, lmCoordM, noSmoothLighting, false, true,
               false, 0, 0.0, 1.0, emission);

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Atmospheric Fog Integration | ØªÙƒØ§Ù…Ù„ Ø§Ù„Ø¶Ø¨Ø§Ø¨ Ø§Ù„Ø¬ÙˆÙŠ
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    #if MC_VERSION >= 11500
        vec3 nViewPos = normalize(viewPos);

        float VdotU = dot(nViewPos, upVec);
        float VdotS = dot(nViewPos, sunVec);
        float sky = 0.0;

        DoFog(color.rgb, sky, lViewPos, playerPos, VdotU, VdotS, dither);
    #endif

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Translucency Multiplier System | Ù†Ø¸Ø§Ù… Ø¶Ø§Ø±Ø¨ Ø§Ù„Ø´ÙØ§ÙÙŠØ©
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    vec3 translucentMult = mix(vec3(0.666), 
                              color.rgb * (1.0 - pow2(pow2(color.a))), 
                              color.a);

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Color Coding Debug System | Ù†Ø¸Ø§Ù… ØªØ±Ù…ÙŠØ² Ø§Ù„Ø£Ù„ÙˆØ§Ù† Ù„Ù„ØªØ·ÙˆÙŠØ±
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    #ifdef COLOR_CODED_PROGRAMS
        ColorCodeProgram(color, -1);
    #endif

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Final Output Buffers | Ù…Ø®Ø§Ø²Ù† Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    /* DRAWBUFFERS:063 */
    gl_FragData[0] = color;                                    // Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ / Final color
    gl_FragData[1] = vec4(0.0, materialMask, 0.0, 1.0);      // Ù‚Ù†Ø§Ø¹ Ø§Ù„Ù…ÙˆØ§Ø¯ / Material mask
    gl_FragData[2] = vec4(1.0 - translucentMult, 1.0);       // Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø´ÙØ§ÙÙŠØ© / Translucency info
}

#endif

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Vertex Shader Implementation | ØªØ·Ø¨ÙŠÙ‚ Vertex Shader
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#ifdef VERTEX_SHADER

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// Output Variables | Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¥Ø®Ø±Ø§Ø¬
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
out vec2 texCoord;      // Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù†Ø³ÙŠØ¬ / Texture coordinates
out vec2 lmCoord;       // Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø®Ø±ÙŠØ·Ø© Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© / Light map coordinates

flat out vec3 upVec, sunVec; // Ù…ØªØ¬Ù‡Ø§Øª Ø§Ù„Ø§ØªØ¬Ø§Ù‡ / Direction vectors
out vec3 normal;        // Ø§Ù„Ù…ØªØ¬Ù‡ Ø§Ù„Ø¹Ù…ÙˆØ¯ÙŠ / Normal vector

flat out vec4 glColor;  // Ù„ÙˆÙ† OpenGL / OpenGL color

#ifdef CLOUD_SHADOWS
    flat out vec3 eastVec; // Ù…ØªØ¬Ù‡ Ø§Ù„Ø´Ø±Ù‚ / East vector

    #if SUN_ANGLE != 0
        flat out vec3 northVec; // Ù…ØªØ¬Ù‡ Ø§Ù„Ø´Ù…Ø§Ù„ / North vector
    #endif
#endif

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// Vertex Processing Main Function | Ø§Ù„Ø¯Ø§Ù„Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© Ù„Ù…Ø¹Ø§Ù„Ø¬Ø© Vertex
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
void main() {
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Primary Vertex Transformation | Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ Ù„Ù„Ù€ Vertex
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    gl_Position = ftransform();

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Texture Coordinate Processing | Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø§Ù„Ù†Ø³ÙŠØ¬
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    texCoord = (gl_TextureMatrix[0] * gl_MultiTexCoord0).xy;
    lmCoord  = GetLightMapCoordinates();

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Color Information Transfer | Ù†Ù‚Ù„ Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø£Ù„ÙˆØ§Ù†
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    glColor = gl_Color;

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Normal and Direction Vector Setup | Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„Ù…ØªØ¬Ù‡Ø§Øª ÙˆØ§Ù„Ø§ØªØ¬Ø§Ù‡Ø§Øª
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    normal = normalize(gl_NormalMatrix * gl_Normal);
    upVec = normalize(gbufferModelView[1].xyz);
    sunVec = GetSunVector();

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Flickering Fix System | Ù†Ø¸Ø§Ù… Ø¥ØµÙ„Ø§Ø­ Ø§Ù„ÙˆÙ…ÙŠØ¶
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    #ifdef FLICKERING_FIX
        gl_Position.z -= 0.000002; // ØªØµØ­ÙŠØ­ Ø¹Ù…Ù‚ ØµØºÙŠØ± / Minor depth correction
    #endif

    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    // Cloud Shadow Vector Setup | Ø¥Ø¹Ø¯Ø§Ø¯ Ù…ØªØ¬Ù‡Ø§Øª Ø¸Ù„Ø§Ù„ Ø§Ù„Ø³Ø­Ø¨
    // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    #ifdef CLOUD_SHADOWS
        eastVec = normalize(gbufferModelView[0].xyz);

        #if SUN_ANGLE != 0
            northVec = normalize(gbufferModelView[2].xyz);
        #endif
    #endif
}

#endif

/*
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    ØªÙ… Ø§Ù„ØªØ·ÙˆÙŠØ± Ø¨ÙˆØ§Ø³Ø·Ø© VcorA - Ù†Ø¸Ø§Ù… Ø±Ù†Ø¯Ø±ÙŠÙ†Øº Ø§Ù„Ø¬Ø³ÙŠÙ…Ø§Øª ÙˆØ§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø³Ø·Ø­ÙŠØ©
    Developed by VcorA - Surface Particle & Atmospheric Effects System
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
*/
